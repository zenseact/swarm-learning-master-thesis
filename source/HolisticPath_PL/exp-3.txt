{'exp_id': 2, 'type': 'centralized', 'agent_id': 1, 'output_size': 51, 'image_size': 256, 'run_pretrained': True, 'batch_size': 8, 'val_factor': 0.1, 'subset_factor': 0.2, 'use_gpu': True, 'model': 'mobile_net', 'num_global_rounds': None, 'num_local_epochs': 250, 'print_debug_data': True, 'num_workers': 4, 'prefetch_factor': 2, 'frames_image_mean': [0.337, 0.345, 0.367], 'frames_image_std': [0.16, 0.18, 0.214], 'dataset_root': '/mnt/ZOD', 'zenseact_dataset_root': '/staging/dataset_donation/round_2', 'checkpoint_path': None, 'start_from_checkpoint': False, 'use_ema': True, 'dataset_division': 'balanced', 'learning_rate': 0.001, 'target_distances': [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85], 'loss': 'L1', 'gpu_id': 0}
PyTorch=2.0.0+cu117. Pytorch vision=0.15.1+cu117. Flower=1.3.0
Training will run on: cudas
exp-2_centralized_agent-1_mobile_net_balanced_L1_85m_imgnet_normalized_250epochs_lr0.001_6800.0trainImages_bs8_imgSize256_unfreezed_ema-True
Loading infos: 0it [00:00, ?it/s]Loading infos: 1001it [00:02, 388.74it/s]Loading infos: 1601it [00:02, 644.59it/s]Loading infos: 3401it [00:02, 1783.99it/s]Loading infos: 4269it [00:03, 2333.50it/s]Loading infos: 5151it [00:03, 2990.71it/s]Loading infos: 5950it [00:03, 3606.50it/s]Loading infos: 6751it [00:03, 4228.82it/s]Loading infos: 7511it [00:03, 4813.85it/s]Loading infos: 8265it [00:03, 5283.90it/s]Loading infos: 9002it [00:03, 5675.31it/s]Loading infos: 9726it [00:03, 6003.37it/s]Loading infos: 10551it [00:03, 6363.54it/s]Loading infos: 11273it [00:06, 799.59it/s] Loading infos: 11951it [00:06, 1055.90it/s]Loading infos: 12701it [00:06, 1428.65it/s]Loading infos: 13315it [00:07, 1648.89it/s]Loading infos: 14901it [00:07, 2945.93it/s]Loading infos: 15736it [00:07, 3462.99it/s]Loading infos: 16519it [00:07, 3981.97it/s]Loading infos: 17271it [00:07, 4513.69it/s]Loading infos: 18011it [00:07, 3852.41it/s]Loading infos: 19751it [00:08, 6109.85it/s]Loading infos: 20680it [00:08, 6370.78it/s]Loading infos: 21547it [00:08, 6489.90it/s]Loading infos: 22359it [00:08, 6405.75it/s]Loading infos: 23113it [00:12, 742.45it/s] Loading infos: 23651it [00:12, 868.16it/s]Loading infos: 25551it [00:12, 1691.72it/s]Loading infos: 26411it [00:12, 2053.80it/s]Loading infos: 27188it [00:12, 2476.60it/s]Loading infos: 27940it [00:12, 2892.70it/s]Loading infos: 28651it [00:12, 3380.57it/s]Loading infos: 29343it [00:12, 3871.81it/s]Loading infos: 30051it [00:13, 4395.86it/s]Loading infos: 30751it [00:13, 4838.11it/s]Loading infos: 31501it [00:13, 5391.10it/s]Loading infos: 32201it [00:13, 5711.36it/s]Loading infos: 32887it [00:13, 5019.56it/s]Loading infos: 34151it [00:13, 6737.16it/s]Loading infos: 34939it [00:13, 6447.58it/s]Loading infos: 35701it [00:13, 6723.50it/s]Loading infos: 36436it [00:13, 6792.07it/s]Loading infos: 37160it [00:14, 6826.51it/s]Loading infos: 37875it [00:18, 535.72it/s] Loading infos: 39001it [00:18, 850.28it/s]Loading infos: 39701it [00:18, 1089.67it/s]Loading infos: 40451it [00:18, 1434.52it/s]Loading infos: 41131it [00:18, 1816.61it/s]Loading infos: 41808it [00:19, 2252.00it/s]Loading infos: 42465it [00:19, 2738.07it/s]Loading infos: 43251it [00:19, 3411.41it/s]Loading infos: 43918it [00:19, 3928.20it/s]Loading infos: 44601it [00:19, 4465.70it/s]Loading infos: 45351it [00:19, 5110.93it/s]Loading infos: 46101it [00:19, 5624.34it/s]Loading infos: 46801it [00:19, 5691.81it/s]Loading infos: 47651it [00:19, 6217.76it/s]Loading infos: 48351it [00:20, 6416.23it/s]Loading infos: 49051it [00:20, 6465.09it/s]Loading infos: 49736it [00:20, 4751.77it/s]Loading infos: 51101it [00:20, 6683.22it/s]Loading infos: 51896it [00:20, 6682.64it/s]Loading infos: 52653it [00:20, 6530.70it/s]Loading infos: 53501it [00:20, 6965.61it/s]Loading infos: 54351it [00:20, 7319.51it/s]Loading infos: 55123it [00:21, 7104.45it/s]Loading infos: 55862it [00:26, 468.42it/s] Loading infos: 56751it [00:26, 674.30it/s]Loading infos: 57401it [00:26, 871.08it/s]Loading infos: 58151it [00:26, 1173.04it/s]Loading infos: 58801it [00:26, 1392.08it/s]Loading infos: 59551it [00:27, 1822.34it/s]Loading infos: 61151it [00:27, 3180.13it/s]Loading infos: 62023it [00:27, 3673.35it/s]Loading infos: 62822it [00:27, 4143.47it/s]Loading infos: 63575it [00:27, 4634.22it/s]Loading infos: 64311it [00:27, 5065.06it/s]Loading infos: 65030it [00:27, 5442.30it/s]Loading infos: 65851it [00:27, 6026.34it/s]Loading infos: 66585it [00:28, 6192.55it/s]Loading infos: 67299it [00:28, 6265.90it/s]Loading infos: 68001it [00:28, 6446.03it/s]Loading infos: 68751it [00:28, 6712.51it/s]Loading infos: 69501it [00:28, 6897.93it/s]Loading infos: 70218it [00:28, 4957.19it/s]Loading infos: 71751it [00:28, 7256.56it/s]Loading infos: 72619it [00:28, 6952.55it/s]Loading infos: 73415it [00:29, 6937.77it/s]Loading infos: 74179it [00:29, 5390.46it/s]Loading infos: 75601it [00:29, 7233.65it/s]Loading infos: 76465it [00:29, 6068.24it/s]Loading infos: 77851it [00:36, 513.24it/s] Loading infos: 79501it [00:36, 825.08it/s]Loading infos: 80321it [00:36, 1007.87it/s]Loading infos: 81151it [00:36, 1274.90it/s]Loading infos: 81951it [00:36, 1608.03it/s]Loading infos: 82710it [00:36, 1987.35it/s]Loading infos: 83442it [00:37, 2429.61it/s]Loading infos: 84159it [00:37, 2637.01it/s]Loading infos: 85351it [00:37, 3754.35it/s]Loading infos: 86121it [00:37, 4321.96it/s]Loading infos: 86885it [00:37, 4236.75it/s]Loading infos: 88001it [00:37, 5444.22it/s]Loading infos: 88789it [00:37, 5730.31it/s]Loading infos: 89542it [00:38, 4866.22it/s]Loading infos: 91001it [00:38, 6707.51it/s]Loading infos: 91854it [00:38, 6719.46it/s]Loading infos: 92654it [00:38, 6479.48it/s]Loading infos: 93451it [00:38, 6771.30it/s]Loading infos: 94198it [00:38, 6787.23it/s]Loading infos: 94926it [00:38, 6492.84it/s]Loading infos: 95610it [00:38, 6518.08it/s]Loading infos: 96351it [00:38, 6585.04it/s]Loading infos: 97201it [00:39, 6912.30it/s]Loading infos: 98001it [00:39, 7157.00it/s]Loading infos: 98728it [00:39, 6989.35it/s]Loading infos: 99801it [00:39, 7994.94it/s]Loading infos: 100000it [00:39, 2536.89it/s]
balanced sample: ['003298', '074927', '038839', '021686', '088515']
  0%|          | 0/7039 [00:00<?, ?it/s]100%|██████████| 7039/7039 [00:00<00:00, 1412212.09it/s]
  0%|          | 0/2004 [00:00<?, ?it/s]100%|██████████| 2004/2004 [00:00<00:00, 1096306.93it/s]
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name    | Type        | Params
----------------------------------------
0 | model   | MobileNetV3 | 6.1 M 
1 | ema     | EMA         | 12.1 M
2 | loss_fn | L1Loss      | 0     
----------------------------------------
6.1 M     Trainable params
6.1 M     Non-trainable params
12.1 M    Total params
48.518    Total estimated model params size (MB)
length of training_frames subset: 7011
length of test_frames subset: 1597
Sanity Checking: 0it [00:00, ?it/s]/home/yasan/miniconda3/envs/zen/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:478: PossibleUserWarning: Your `val_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.
  rank_zero_warn(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]True
Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:02<00:02,  2.50s/it]True
Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:02<00:00,  1.26s/it]                                                                           Training: 0it [00:00, ?it/s]Training:   0%|          | 0/789 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/789 [00:00<?, ?it/s] True
Epoch 0:   0%|          | 1/789 [00:07<1:40:26,  7.65s/it]Epoch 0:   0%|          | 1/789 [00:07<1:40:28,  7.65s/it, v_num=52]True
Epoch 0:   0%|          | 2/789 [00:07<50:35,  3.86s/it, v_num=52]  Epoch 0:   0%|          | 2/789 [00:07<50:35,  3.86s/it, v_num=52]True
Epoch 0:   0%|          | 3/789 [00:07<33:55,  2.59s/it, v_num=52]Epoch 0:   0%|          | 3/789 [00:07<33:56,  2.59s/it, v_num=52]True
Epoch 0:   1%|          | 4/789 [00:07<25:40,  1.96s/it, v_num=52]Epoch 0:   1%|          | 4/789 [00:07<25:40,  1.96s/it, v_num=52]True
Epoch 0:   1%|          | 5/789 [00:12<33:46,  2.59s/it, v_num=52]Epoch 0:   1%|          | 5/789 [00:12<33:47,  2.59s/it, v_num=52]True
Epoch 0:   1%|          | 6/789 [00:13<28:56,  2.22s/it, v_num=52]Epoch 0:   1%|          | 6/789 [00:13<28:56,  2.22s/it, v_num=52]True
Epoch 0:   1%|          | 7/789 [00:13<24:58,  1.92s/it, v_num=52]Epoch 0:   1%|          | 7/789 [00:13<24:58,  1.92s/it, v_num=52]True
Epoch 0:   1%|          | 8/789 [00:13<21:55,  1.68s/it, v_num=52]Epoch 0:   1%|          | 8/789 [00:13<21:55,  1.68s/it, v_num=52]